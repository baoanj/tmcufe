webpackJsonp([1],{"1u1Y":function(t,e){},"4+Nm":function(t,e){},"48aW":function(t,e){},"4ZQ+":function(t,e){},"6Uso":function(t,e){},AEiT:function(t,e){},AsOY:function(t,e){},B5Qf:function(t,e){},Bsm3:function(t,e){},Dqvi:function(t,e){},F718:function(t,e){},JEKt:function(t,e){},Jcsu:function(t,e){},Jz3J:function(t,e){},Lpum:function(t,e){},MzRF:function(t,e){},N1Mz:function(t,e){},NGYI:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("/5sW"),r=s("zL8q"),i=s.n(r),n=(s("tvR6"),s("OS1Z")),o=s.n(n),l=s("DAYN"),c=s.n(l),u=s("Bb5x"),d=(s("pw1w"),s("WiKS")),m=s.n(d),f=s("//Fk"),h=s.n(f),p=s("mtWM"),v=s.n(p),g={get:function(t,e,s){return new h.a(function(a,r){v.a.get(t,{params:e,responseType:s}).then(function(t){a(t.data)}).catch(function(){r()})})},post:function(t,e){return new h.a(function(s,a){v.a.post(t,e).then(function(t){s(t.data)}).catch(function(){a()})})},put:function(t,e){return new h.a(function(s,a){v.a.put(t,e).then(function(t){s(t.data)}).catch(function(){a()})})}};var b={name:"EditProfileDialog",data:function(){return{visible:!1,loading:!1,ruleForm:{name:"",stuId:""},rules:{name:[{required:!0,validator:function(t,e,s){""===e?s(new Error("必填")):s()},trigger:"blur"}],stuId:[{required:!0,validator:function(t,e,s){""===e?s(new Error("必填")):s()},trigger:"blur"}]}}},methods:{show:function(t,e){this.ruleForm.name=t,this.ruleForm.stuId=e,this.visible=!0},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){var s;t&&(e.loading=!0,(s={name:e.ruleForm.name,stuId:e.ruleForm.stuId},new h.a(function(t,e){g.put("/api/student/editUserMsg",s).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){t()})})).then(function(){e.visible=!1,e.loading=!1,e.$store.dispatch("refreshHeader")}).catch(function(t){e.loading=!1,e.$message.error(t)}))})},closeDialog:function(){this.visible=!1,this.$refs.ruleForm.clearValidate()}}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{title:"修改个人信息",width:"50%",modal:!1,visible:t.visible},on:{close:t.closeDialog}},[s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"姓名",prop:"name"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"学号",prop:"stuId"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.stuId,callback:function(e){t.$set(t.ruleForm,"stuId",e)},expression:"ruleForm.stuId"}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:t.closeDialog}},[t._v("取消")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:t.loading},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var _={name:"TopHeader",created:function(){this.$store.dispatch("refreshHeader")},components:{EditProfileDialog:s("VU/8")(b,w,!1,function(t){s("Jcsu")},"data-v-117d296c",null).exports},methods:{login:function(){this.$router.push("/login")},regist:function(){this.$router.push("/regist")},logout:function(){var t=this;new h.a(function(t,e){g.post("/api/general/logout").then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})}).then(function(){t.$store.dispatch("refreshHeader"),t.$router.push("/login")}).catch(function(e){t.$message.error(e)})},handleCommand:function(t){"editProfile"===t?this.$refs.editProfileDialogRef.show(this.$store.state.user.name,this.$store.state.user.stuId):"logout"===t&&this.logout()}},filters:{roleFilter:function(t,e){return"teacher"===t?"老师":"("+e+") 同学"}}},F={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",[s("el-col",{attrs:{span:12}},[s("router-link",{staticClass:"header-link",attrs:{to:"/"}},[t._v("高校教学管理系统")])],1),t._v(" "),s("el-col",{attrs:{span:12}},[t.$store.state.user.name?s("div",{staticClass:"profile"},[s("span",{staticClass:"profile-msg"},[t._v("\n          "+t._s(t.$store.state.user.name)+"\n          "+t._s(t._f("roleFilter")(t.$store.state.user.role,t.$store.state.user.stuId))+"\n        ")]),t._v(" "),s("el-dropdown",{attrs:{placement:"bottom"},on:{command:t.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["student"===t.$store.state.user.role?s("el-dropdown-item",{attrs:{command:"editProfile"}},[t._v("修改姓名学号")]):t._e(),t._v(" "),s("el-dropdown-item",{attrs:{command:"logout"}},[t._v("退出")])],1)],1)],1):s("div",{staticClass:"profile"},[s("el-button",{attrs:{type:"primary"},on:{click:t.login}},[t._v("登录")]),t._v(" "),s("el-button",{on:{click:t.regist}},[t._v("注册")])],1)])],1),t._v(" "),s("edit-profile-dialog",{ref:"editProfileDialogRef"})],1)},staticRenderFns:[]};var k=s("VU/8")(_,F,!1,function(t){s("Uh4q")},"data-v-3dea5d2a",null).exports,D=(s("zGTM"),{name:"App",components:{TopHeader:k}}),$={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-container",[e("el-header",{staticClass:"top-header"},[e("top-header")],1),this._v(" "),e("el-main",{staticClass:"main-container"},[e("router-view")],1)],1)],1)},staticRenderFns:[]};var C=s("VU/8")(D,$,!1,function(t){s("B5Qf")},"data-v-132193f2",null).exports,x=s("/ocq");function I(t){return new h.a(function(e,s){g.post("/api/teacher/checkClassIdUnique",{classId:t}).then(function(t){0===t.stats?s(t.data.error):e()}).catch(function(){e()})})}var y={name:"ClassCard",props:{classs:{type:Object,default:function(){return{}}},move:{type:Boolean,default:!1}}},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{"box-card-1":!0,"box-card-2":!0,"box-card-move":t.move}},[s("el-card",[s("div",{staticClass:"clearfix text-line",attrs:{slot:"header"},slot:"header"},[s("router-link",{staticClass:"card-text-btn",attrs:{title:t.classs.name,to:{name:"ClassPage",params:{classId:t.classs.classId}}}},[t._v(t._s(t.classs.name))])],1),t._v(" "),s("div",[s("el-form",{attrs:{"label-width":"80px",size:"small"}},[s("el-form-item",{attrs:{label:"班级Id:"}},[t._v("\n          "+t._s(t.classs.classId)+"\n        ")]),t._v(" "),s("el-form-item",{attrs:{label:"密码:"}},[t._v("\n          "+t._s(t.classs.password)+"\n        ")]),t._v(" "),s("el-form-item",{attrs:{label:"任课老师:"}},[t._v("\n          "+t._s(t.classs.teacherName||"--")+"\n        ")]),t._v(" "),s("el-form-item",{attrs:{label:"作业数量:"}},[t._v("\n          "+t._s(t.classs.anountOfHws)+"\n        ")]),t._v(" "),s("el-form-item",{attrs:{label:"学生数量:"}},[t._v("\n          "+t._s(t.classs.amountOfStus)+"\n        ")])],1)],1)])],1)},staticRenderFns:[]};var E=s("VU/8")(y,S,!1,function(t){s("JEKt")},"data-v-329d6c0e",null).exports,V={bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!1,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!1,help:!0,undo:!0,redo:!0,trash:!0,save:!1,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0},A={name:"MarkdownEditor",props:{edit:{type:Boolean,default:!0},value:{type:String,default:""}},data:function(){return{toolbars:V}}},L={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.edit?s("div",{staticClass:"edit"},[s("mavon-editor",{attrs:{toolbars:t.toolbars,value:t.value},on:{change:function(e){return t.$emit("change",e)}}})],1):s("div",{staticClass:"not-edit"},[s("mavon-editor",{attrs:{toolbarsFlag:!1,subfield:!1,defaultOpen:"preview",value:t.value}})],1)])},staticRenderFns:[]};var H=s("VU/8")(A,L,!1,function(t){s("Vm1m")},"data-v-f2a53e86",null).exports,R={name:"FullscreenDialog",props:{visible:{type:Boolean,default:!1},title:{type:String,default:""}}},T={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{title:t.title,fullscreen:!0,center:!0,visible:t.visible,"show-close":!1}},[t._t("default"),t._v(" "),s("el-button",{staticClass:"close",attrs:{type:"primary",icon:"el-icon-close",circle:""},on:{click:function(e){t.$emit("close")}}})],2)},staticRenderFns:[]};var P=s("VU/8")(R,T,!1,function(t){s("nGs6")},"data-v-f954c1f4",null).exports,N={name:"AddClassDialog",props:{dialogVisible:{type:Boolean,default:!1}},components:{MarkdownEditor:H,FullscreenDialog:P},data:function(){return{ruleForm:{classId:"",name:"",teacherName:"",password:"",message:""},rules:{classId:[{required:!0,validator:function(t,e,s){e?I(e).then(function(){s()},function(t){s(new Error(t))}):s(new Error("必填"))},trigger:"blur"}],name:[{required:!0,validator:function(t,e,s){""===e?s(new Error("必填")):s()},trigger:"blur"}],password:[{required:!0,validator:function(t,e,s){""===e?s(new Error("请输入密码")):s()},trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){var s;t&&(s={classId:e.ruleForm.classId,name:e.ruleForm.name,teacherName:e.ruleForm.teacherName,password:e.ruleForm.password,message:e.ruleForm.message},new h.a(function(t,e){g.post("/api/teacher/addClass",s).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.$emit("hideDialog"),e.$emit("fetchData")}).catch(function(t){e.$message.error(t)})})},closeDialog:function(){this.resetForm("ruleForm"),this.$emit("hideDialog")},resetForm:function(t){this.$refs[t].resetFields()}}},M={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fullscreen-dialog",{attrs:{title:"新建班级",visible:t.dialogVisible},on:{close:t.closeDialog}},[s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"班级Id",prop:"classId"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.classId,callback:function(e){t.$set(t.ruleForm,"classId",e)},expression:"ruleForm.classId"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"班级名称",prop:"name"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"其他信息",prop:"message"}},[s("markdown-editor",{attrs:{value:t.ruleForm.message},on:{change:function(e){return t.ruleForm.message=e}}})],1),t._v(" "),s("el-form-item",{attrs:{label:"任课教师",prop:"teacherName"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.teacherName,callback:function(e){t.$set(t.ruleForm,"teacherName",e)},expression:"ruleForm.teacherName"}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:t.closeDialog}},[t._v("取消")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var U=s("VU/8")(N,M,!1,function(t){s("Jz3J")},"data-v-316e96d4",null).exports,z={name:"EnterClassDialog",props:{dialogVisible:{type:Boolean,default:!1}},data:function(){return{ruleForm:{classId:"",password:""},rules:{classId:[{validator:function(t,e,s){e?I(e).then(function(){s(new Error("班级Id不存在"))},function(){s()}):s(new Error("必填"))},trigger:"blur"}],password:[{validator:function(t,e,s){""===e?s(new Error("请输入密码")):s()},trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){var s;t&&(s={classId:e.ruleForm.classId,password:e.ruleForm.password},new h.a(function(t,e){g.post("/api/student/enterClass",s).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.$emit("hideDialog"),e.$emit("fetchData")}).catch(function(t){e.$message.error(t)})})},closeDialog:function(){this.resetForm("ruleForm"),this.$emit("hideDialog")},resetForm:function(t){this.$refs[t].resetFields()}}},G={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{title:"添加班级",visible:t.dialogVisible},on:{close:t.closeDialog}},[s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"班级Id",prop:"classId"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.classId,callback:function(e){t.$set(t.ruleForm,"classId",e)},expression:"ruleForm.classId"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:t.closeDialog}},[t._v("取消")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var O={name:"Home",components:{ClassCard:E,AddClassDialog:U,EnterClassDialog:s("VU/8")(z,G,!1,function(t){s("ZxD1")},"data-v-21e9e8e7",null).exports},created:function(){this.fetchData()},data:function(){return{classes:[],classIds:[],moveClassIds:[],addClassDialogVisible:!1,enterClassDialogVisible:!1,moving:!1,draggableOptions:{ghostClass:"ghost-move"}}},computed:{sortableClasses:function(){for(var t={},e=0;e<this.classes.length;e+=1)t[this.classes[e].classId]=this.classes[e];for(var s=[],a=0;a<this.classIds.length;a+=1)s.push(t[this.classIds[a]]);return s},sortableMoveClasses:{get:function(){for(var t={},e=0;e<this.classes.length;e+=1)t[this.classes[e].classId]=this.classes[e];for(var s=[],a=0;a<this.moveClassIds.length;a+=1)s.push(t[this.moveClassIds[a]]);return s},set:function(t){for(var e=[],s=0;s<t.length;s+=1)e.push(t[s].classId);this.moveClassIds=e}}},methods:{fetchData:function(){var t=this;new h.a(function(t,e){g.get("/api/general/getClasses").then(function(s){1===s.stats?t(s.data):e(s.data.error)}).catch(function(){e("网络错误")})}).then(function(e){t.classes=e.classes,t.classIds=e.classIds,t.moveClassIds=e.classIds}).catch(function(e){t.$message.error(e)})},addClass:function(){this.addClassDialogVisible=!0},enterClass:function(){this.enterClassDialogVisible=!0},submitMove:function(){var t,e=this;(t={classIds:this.moveClassIds},new h.a(function(e,s){g.put("/api/general/moveClasses",t).then(function(t){0===t.stats?s(t.data.error):e()}).catch(function(){s("网络错误")})})).then(function(){e.fetchData(),e.moving=!1}).catch(function(t){e.$message.error(t)})},cancelMove:function(){this.moving=!1,this.moveClassIds=this.classIds}}},q={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.$store.state.user.name?s("div",[s("vue-headful",{attrs:{title:"高校教学管理系统"}}),t._v(" "),s("div",{staticClass:"home-operate-container"},[s("div",{staticClass:"home-operate-content"},["teacher"===t.$store.state.user.role?s("el-button",{attrs:{type:"primary"},on:{click:t.addClass}},[t._v("新建班级")]):t._e(),t._v(" "),"student"===t.$store.state.user.role?s("el-button",{attrs:{type:"primary"},on:{click:t.enterClass}},[t._v("添加班级")]):t._e(),t._v(" "),t.moving?t._e():s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.moving=!0}}},[t._v("移动班级")]),t._v(" "),t.moving?s("el-button",{attrs:{type:"primary"},on:{click:t.cancelMove}},[t._v("放弃移动")]):t._e(),t._v(" "),t.moving?s("el-button",{attrs:{type:"primary"},on:{click:t.submitMove}},[t._v("提交移动")]):t._e(),t._v(" "),t.moving?s("span",{staticClass:"move-note"},[t._v("拖动下方卡片即可移动")]):t._e()],1)]),t._v(" "),t.moving?s("div",[s("vue-draggable",{attrs:{options:t.draggableOptions},model:{value:t.sortableMoveClasses,callback:function(e){t.sortableMoveClasses=e},expression:"sortableMoveClasses"}},[s("transition-group",t._l(t.sortableMoveClasses,function(e){return s("class-card",{key:e.classId,attrs:{classs:e,move:t.moving}})}))],1)],1):s("div",t._l(t.sortableClasses,function(e){return s("class-card",{key:e.classId,attrs:{classs:e,move:t.moving}})})),t._v(" "),"teacher"===t.$store.state.user.role?s("add-class-dialog",{attrs:{dialogVisible:t.addClassDialogVisible},on:{hideDialog:function(e){t.addClassDialogVisible=!1},fetchData:t.fetchData}}):t._e(),t._v(" "),"student"===t.$store.state.user.role?s("enter-class-dialog",{attrs:{dialogVisible:t.enterClassDialogVisible},on:{hideDialog:function(e){t.enterClassDialogVisible=!1},fetchData:t.fetchData}}):t._e()],1):t._e()},staticRenderFns:[]};var Z=s("VU/8")(O,q,!1,function(t){s("AsOY")},"data-v-3d7939b4",null).exports;function j(t){return new h.a(function(e,s){g.post("/api/general/checkEmail",{email:t}).then(function(t){0===t.stats?s(t.data.error):e()}).catch(function(){s("网络错误")})})}function B(){return new h.a(function(t,e){g.get("/api/general/getCaptcha").then(function(s){0===s.stats?e(s.data.error):t(s.data.captcha)}).catch(function(){e("网络错误")})})}function K(t){return new h.a(function(e,s){g.post("/api/general/checkCaptcha",{captcha:t}).then(function(t){0===t.stats?s(t.data.error):e()}).catch(function(){s("网络错误")})})}var J={name:"RegistPage",created:function(){this.getCaptchaSVG()},data:function(){var t=this;return{ruleForm:{email:"",name:"",stuId:"",password:"",checkPass:"",captcha:"",role:"student"},rules:{email:[{validator:function(t,e,s){e?/^[a-zA-Z0-9\-_]+@([a-zA-Z0-9]+\.)+[a-z]{2,4}$/.test(e)?j(e).then(function(){s()},function(t){s(new Error(t))}):s(new Error("邮箱格式有误")):s(new Error("必填"))},trigger:"blur"}],name:[{validator:function(t,e,s){e?s():s(new Error("必填"))},trigger:"blur"}],stuId:[{validator:function(e,s,a){s||"student"!==t.ruleForm.role?a():a(new Error("必填"))},trigger:"blur"}],password:[{validator:function(e,s,a){""===s?a(new Error("请输入密码")):(""!==t.ruleForm.checkPass&&t.$refs.ruleForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:function(e,s,a){""===s?a(new Error("请再次输入密码")):s!==t.ruleForm.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}],captcha:[{validator:function(t,e,s){""===e?s(new Error("请输入验证码")):/^[a-zA-Z0-9]{4}$/.test(e)?K(e).then(function(){s()}).catch(function(t){s(new Error(t))}):s(new Error("验证码格式错误"))},trigger:"blur"}]},captchaSVG:""}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){var s;t&&(s={name:e.ruleForm.name,stuId:e.ruleForm.stuId,email:e.ruleForm.email,password:e.ruleForm.password,role:e.ruleForm.role,captcha:e.ruleForm.captcha},new h.a(function(t,e){g.post("/api/general/regist",s).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.$message.success("注册成功，请登录"),e.$router.push("/login")}).catch(function(t){e.$message.error(t),e.getCaptchaSVG()})})},getCaptchaSVG:function(){var t=this;B().then(function(e){t.captchaSVG=e}).catch(function(e){t.captchaSVG="获取验证码失败",t.$message.error(e)})},resetForm:function(t){this.$refs[t].resetFields()}}},Y={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"regist-box"},[s("vue-headful",{attrs:{title:"高校教学管理系统 | 注册"}}),t._v(" "),s("p",{staticClass:"regist-title"},[t._v("用户注册")]),t._v(" "),s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.email,callback:function(e){t.$set(t.ruleForm,"email",e)},expression:"ruleForm.email"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"姓名",prop:"name"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"student"===t.ruleForm.role,expression:"ruleForm.role === 'student'"}],attrs:{label:"学号",prop:"stuId"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.stuId,callback:function(e){t.$set(t.ruleForm,"stuId",e)},expression:"ruleForm.stuId"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[s("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.ruleForm.checkPass,callback:function(e){t.$set(t.ruleForm,"checkPass",e)},expression:"ruleForm.checkPass"}})],1),t._v(" "),s("el-form-item",{staticClass:"captcha-form-item",attrs:{label:"验证码",prop:"captcha"}},[s("el-input",{staticClass:"captcha-input",model:{value:t.ruleForm.captcha,callback:function(e){t.$set(t.ruleForm,"captcha",e)},expression:"ruleForm.captcha"}}),t._v(" "),s("span",{domProps:{innerHTML:t._s(t.captchaSVG)},on:{click:t.getCaptchaSVG}})],1),t._v(" "),s("el-form-item",[s("el-radio-group",{model:{value:t.ruleForm.role,callback:function(e){t.$set(t.ruleForm,"role",e)},expression:"ruleForm.role"}},[s("el-radio",{attrs:{label:"student"}},[t._v("学生")]),t._v(" "),s("el-radio",{attrs:{label:"teacher"}},[t._v("老师")])],1)],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("重置")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var W=s("VU/8")(J,Y,!1,function(t){s("4+Nm"),s("lJbM")},"data-v-6bdf66ee",null).exports,Q={name:"LoginPage",created:function(){this.getCaptchaSVG()},data:function(){return{ruleForm:{email:"",password:"",captcha:""},rules:{email:[{validator:function(t,e,s){e?/^[a-zA-Z0-9\-_]+@([a-zA-Z0-9]+\.)+[a-z]{2,4}$/.test(e)?j(e).then(function(){s(new Error("该邮箱未注册"))},function(){s()}):s(new Error("邮箱格式有误")):s(new Error("必填"))},trigger:"blur"}],password:[{validator:function(t,e,s){""===e?s(new Error("请输入密码")):s()},trigger:"blur"}],captcha:[{validator:function(t,e,s){""===e?s(new Error("请输入验证码")):/^[a-zA-Z0-9]{4}$/.test(e)?K(e).then(function(){s()}).catch(function(t){s(new Error(t))}):s(new Error("验证码格式错误"))},trigger:"blur"}]},captchaSVG:""}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){var s;t&&(s={email:e.ruleForm.email,password:e.ruleForm.password,captcha:e.ruleForm.captcha},new h.a(function(t,e){g.post("/api/general/login",s).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.$store.dispatch("refreshHeader"),e.$router.push("/")}).catch(function(t){e.$message.error(t),e.getCaptchaSVG()})})},resetForm:function(t){this.$refs[t].resetFields()},getCaptchaSVG:function(){var t=this;B().then(function(e){t.captchaSVG=e}).catch(function(e){t.captchaSVG="获取验证码失败",t.$message.error(e)})}}},X={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login-box"},[s("vue-headful",{attrs:{title:"高校教学管理系统 | 登录"}}),t._v(" "),s("p",{staticClass:"login-title"},[t._v("用户登录")]),t._v(" "),s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.email,callback:function(e){t.$set(t.ruleForm,"email",e)},expression:"ruleForm.email"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password"},model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),t._v(" "),s("el-form-item",{staticClass:"captcha-form-item",attrs:{label:"验证码",prop:"captcha"}},[s("el-input",{staticClass:"captcha-input",model:{value:t.ruleForm.captcha,callback:function(e){t.$set(t.ruleForm,"captcha",e)},expression:"ruleForm.captcha"}}),t._v(" "),s("span",{domProps:{innerHTML:t._s(t.captchaSVG)},on:{click:t.getCaptchaSVG}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("重置")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("登录")])],1),t._v(" "),s("el-form-item",[s("router-link",{staticClass:"tmcu-btn",attrs:{to:"/forgot"}},[t._v("忘记密码?")])],1)],1)],1)},staticRenderFns:[]};var tt=s("VU/8")(Q,X,!1,function(t){s("Bsm3"),s("F718")},"data-v-503efef7",null).exports,et={name:"ForgotPassword",created:function(){this.getCaptchaSVG()},data:function(){return{success:!1,ruleForm:{email:"",captcha:""},rules:{email:[{validator:function(t,e,s){e?/^[a-zA-Z0-9\-_]+@([a-zA-Z0-9]+\.)+[a-z]{2,4}$/.test(e)?j(e).then(function(){s(new Error("该邮箱未注册"))},function(){s()}):s(new Error("邮箱格式有误")):s(new Error("必填"))},trigger:"blur"}],captcha:[{validator:function(t,e,s){""===e?s(new Error("请输入验证码")):/^[a-zA-Z0-9]{4}$/.test(e)?K(e).then(function(){s()}).catch(function(t){s(new Error(t))}):s(new Error("验证码格式错误"))},trigger:"blur"}]},captchaSVG:"",loading:!1}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){var s;t&&(e.loading=!0,(s={email:e.ruleForm.email,captcha:e.ruleForm.captcha,host:window.location.host},new h.a(function(t,e){g.post("/api/general/forgotPass",s).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.loading=!1,e.success=!0}).catch(function(t){e.loading=!1,e.$message.error(t),e.getCaptchaSVG()}))})},resetForm:function(t){this.$refs[t].resetFields()},getCaptchaSVG:function(){var t=this;B().then(function(e){t.captchaSVG=e}).catch(function(e){t.captchaSVG="获取验证码失败",t.$message.error(e)})},tryAgain:function(t){this.success=!1,this.$refs[t].resetFields(),this.getCaptchaSVG()}}},st={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login-box"},[s("vue-headful",{attrs:{title:"高校教学管理系统 | 忘记密码"}}),t._v(" "),t.success?s("div",{staticClass:"success-msg"},[s("span",{staticClass:"tmcu-text"},[t._v("邮件已发送到 "+t._s(t.ruleForm.email))]),t._v(" "),s("span",{staticClass:"tmcu-btn",on:{click:function(e){t.tryAgain("ruleForm")}}},[t._v("没收到?重新尝试")])]):s("div",[s("p",{staticClass:"login-title"},[t._v("忘记密码")]),t._v(" "),s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.email,callback:function(e){t.$set(t.ruleForm,"email",e)},expression:"ruleForm.email"}})],1),t._v(" "),s("el-form-item",{staticClass:"captcha-form-item",attrs:{label:"验证码",prop:"captcha"}},[s("el-input",{staticClass:"captcha-input",model:{value:t.ruleForm.captcha,callback:function(e){t.$set(t.ruleForm,"captcha",e)},expression:"ruleForm.captcha"}}),t._v(" "),s("span",{domProps:{innerHTML:t._s(t.captchaSVG)},on:{click:t.getCaptchaSVG}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("重置")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:t.loading},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1)],1)},staticRenderFns:[]};var at=s("VU/8")(et,st,!1,function(t){s("MzRF"),s("1u1Y")},"data-v-43d0d653",null).exports,rt={name:"ResetPassword",created:function(){var t,e=this;(t=this.$route.params.resetId,new h.a(function(e,s){g.post("/api/general/checkReset/"+t).then(function(t){0===t.stats?s(t.data.error):e()}).catch(function(){s("网络错误")})})).then(function(){e.valid=!0,e.invalidMsg=""}).catch(function(t){e.valid=!1,e.invalidMsg=t})},data:function(){var t=this;return{valid:!0,invalidMsg:"",ruleForm:{password:"",checkPass:""},rules:{password:[{validator:function(e,s,a){""===s?a(new Error("请输入密码")):(""!==t.ruleForm.checkPass&&t.$refs.ruleForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:function(e,s,a){""===s?a(new Error("请再次输入密码")):s!==t.ruleForm.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){var s,a;t&&(s=e.$route.params.resetId,a={password:e.ruleForm.password},new h.a(function(t,e){g.post("/api/general/resetPass/"+s,a).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.$message.success("重置成功，请登录"),e.$router.push("/login")}).catch(function(t){e.$message.error(t)})})},resetForm:function(t){this.$refs[t].resetFields()}}},it={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"reset-box"},[s("vue-headful",{attrs:{title:"高校教学管理系统 | 重置密码"}}),t._v(" "),t.valid?s("div",[s("p",{staticClass:"reset-title"},[t._v("重置密码")]),t._v(" "),s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[s("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.ruleForm.checkPass,callback:function(e){t.$set(t.ruleForm,"checkPass",e)},expression:"ruleForm.checkPass"}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("重置")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1):s("div",{staticClass:"invalid-msg"},[s("p",{staticClass:"tmcu-text"},[t._v(t._s(t.invalidMsg))])])],1)},staticRenderFns:[]};var nt=s("VU/8")(rt,it,!1,function(t){s("4ZQ+"),s("Lpum")},"data-v-3563e344",null).exports;var ot={name:"UploadFiles",props:{files:{type:Array,default:function(){return[]}}},data:function(){return{fileList:this.files}},watch:{fileList:function(t){this.$emit("change",t)},files:function(t){this.fileList=t}},methods:{customUpload:function(t){for(var e=t.file,s=0;s<this.fileList.length;s+=1)if(this.fileList[s].name===e.name)return void this.$message.error("文件已存在");e.size>10485760?this.$message.error("文件不能大于10M"):this.fileList.length>=10?this.$message.error("最多只能上传10个文件"):this.fileList.push(e)},removeFile:function(t){this.fileList=this.fileList.filter(function(e){return e.name!==t})}}},lt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-upload",{attrs:{action:"\\\\",drag:"","show-file-list":!1,"http-request":t.customUpload}},[s("i",{staticClass:"el-icon-upload"}),t._v(" "),s("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),s("em",[t._v("点击上传")])]),t._v(" "),s("div",{staticClass:"el-upload__tip"},[t._v("最多可上传10个文件，每个不能超过10M")])]),t._v(" "),s("ul",{staticClass:"file-list"},t._l(t.files,function(e){return s("li",{key:e.name,staticClass:"tmcu-text"},[s("i",{staticClass:"el-icon-document"}),t._v(" "),s("span",[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"tmcu-btn",on:{click:function(s){t.removeFile(e.name)}}},[s("i",{staticClass:"el-icon-close"})])])}))],1)},staticRenderFns:[]};var ct=s("VU/8")(ot,lt,!1,function(t){s("Qhht")},"data-v-588892a1",null).exports,ut=s("fZjL"),dt=s.n(ut),mt=s("Zrlr"),ft=s.n(mt),ht={formateDate:function(t){var e=new Date(t);return e.getFullYear()+"-"+this.zeroFill(e.getMonth()+1)+"-"+this.zeroFill(e.getDate())+" "+this.zeroFill(e.getHours())+":"+this.zeroFill(e.getMinutes())+":"+this.zeroFill(e.getSeconds())},zeroFill:function(t){return("0"+t).slice(-2)},isString:function(t){return"string"==typeof t},isArray:function(t){return"[object Array]"==={}.toString.apply(t)},isPureObject:function(t){return"[object Object]"==={}.toString.apply(t)},isFile:function(t){return"[object File]"==={}.toString.apply(t)},isInteger:function(t){return"number"==typeof t&&t%1==0},isPositiveInteger:function(t){return"number"==typeof t&&t%1==0&&t>0},isNaturalNumber:function(t){return"number"==typeof t&&t%1==0&&t>=0},isIntegerStr:function(t){return"string"==typeof t&&/^-?\d+$/.test(t)},isNaturalNumberStr:function(t){return"string"==typeof t&&/^\d+$/.test(t)},isPositiveIntegerStr:function(t){return"string"==typeof t&&/^[0-9]*[1-9][0-9]*$/.test(t)},isFloatStr:function(t){return"string"==typeof t&&/^(-?\d+)(\.\d+)?$/.test(t)},validEmail:function(t){return/^[A-Za-z0-9\.\+_-]+@[A-Za-z0-9\._-]+\.[a-zA-Z]+$/.test(t)},validPhone:function(t){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(t)},validPassword:function(t){return/^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])[a-zA-Z0-9^\S]{6,32}$/.test(t)}},pt=function t(e){ft()(this,t);for(var s=new FormData,a=dt()(e),r=0;r<a.length;r+=1)if(void 0!==e[a[r]])if(ht.isArray(e[a[r]]))for(var i=0;i<e[a[r]].length;i+=1)s.append(a[r],e[a[r]][i]);else s.append(a[r],e[a[r]]);return s},vt={name:"AddHomeworkDialog",props:{dialogVisible:{type:Boolean,default:!1},classId:{type:String,default:""}},components:{MarkdownEditor:H,UploadFiles:ct,FullscreenDialog:P},data:function(){var t=function(t,e,s){e?s():s(new Error("必填"))};return{fileList:[],ruleForm:{title:"",description:"",beginDate:"",endDate:""},rules:{title:[{required:!0,validator:function(t,e,s){""===e?s(new Error("必填")):s()},trigger:"blur"}],beginDate:[{validator:t,trigger:"blur"}],endDate:[{validator:t,trigger:"blur"}]},pickerOptions:{shortcuts:[{text:"三天后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+2592e5),t.$emit("pick",e)}},{text:"五天后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+432e6),t.$emit("pick",e)}},{text:"一周后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+6048e5),t.$emit("pick",e)}},{text:"两周后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+12096e5),t.$emit("pick",e)}}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var s=new pt({files:e.fileList,createDate:Date.now(),title:e.ruleForm.title,description:e.ruleForm.description,beginDate:e.ruleForm.beginDate.getTime(),endDate:e.ruleForm.endDate.getTime()});(a=e.classId,r=s,new h.a(function(t,e){g.post("/api/teacher/addHw/"+a,r).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.$emit("hideDialog"),e.$emit("fetchData")}).catch(function(t){e.$message.error(t)})}var a,r})},closeDialog:function(){this.resetForm("ruleForm"),this.$emit("hideDialog")},resetForm:function(t){this.$refs[t].resetFields(),this.fileList=[]}}},gt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fullscreen-dialog",{attrs:{title:"创建作业",visible:t.dialogVisible},on:{close:t.closeDialog}},[s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"作业标题",prop:"title"}},[s("el-input",{model:{value:t.ruleForm.title,callback:function(e){t.$set(t.ruleForm,"title",e)},expression:"ruleForm.title"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"作业详情",prop:"description"}},[s("markdown-editor",{attrs:{value:t.ruleForm.description},on:{change:function(e){return t.ruleForm.description=e}}})],1),t._v(" "),s("el-form-item",{attrs:{label:"开始时间",prop:"beginDate"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.ruleForm.beginDate,callback:function(e){t.$set(t.ruleForm,"beginDate",e)},expression:"ruleForm.beginDate"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"结束时间",prop:"endDate"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","picker-options":t.pickerOptions},model:{value:t.ruleForm.endDate,callback:function(e){t.$set(t.ruleForm,"endDate",e)},expression:"ruleForm.endDate"}})],1),t._v(" "),s("div",{staticClass:"form-item-upload"},[s("upload-files",{attrs:{files:t.fileList},on:{change:function(e){return t.fileList=e}}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:t.closeDialog}},[t._v("取消")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var bt=s("VU/8")(vt,gt,!1,function(t){s("sAEl")},"data-v-65455b70",null).exports,wt={name:"HomeworkItem",props:{homework:{type:Object,default:function(){return{}}},classId:{type:String,default:""}},methods:{formateDate:function(t){return ht.formateDate(+t)}}},_t={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"box-card-1 box-card-2"},[s("el-card",[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("router-link",{staticClass:"card-text-btn",attrs:{title:t.homework.title,to:{name:"HomeworkPage",params:{classId:t.classId,createDate:t.homework.createDate}}}},[t._v(t._s(t.homework.title))])],1),t._v(" "),s("div",[s("el-form",{attrs:{"label-width":"80px",size:"small"}},[s("el-form-item",{attrs:{label:"创建时间:"}},[t._v("\n          "+t._s(t.formateDate(t.homework.createDate))+"\n        ")]),t._v(" "),s("el-form-item",{attrs:{label:"开始时间:"}},[t._v("\n          "+t._s(t.formateDate(t.homework.beginDate))+"\n        ")]),t._v(" "),s("el-form-item",{attrs:{label:"结束时间:"}},[t._v("\n          "+t._s(t.formateDate(t.homework.endDate))+"\n        ")]),t._v(" "),s("el-form-item",{attrs:{label:"提交人数:"}},[t._v("\n          "+t._s(t.homework.amountOfSubs)+"\n        ")])],1)],1)])],1)},staticRenderFns:[]};var Ft=s("VU/8")(wt,_t,!1,function(t){s("6Uso")},"data-v-59016d58",null).exports,kt={name:"FileList",props:{files:{type:Array,default:function(){return[]},required:!0}}},Dt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.files.length?s("p",{staticClass:"note tmcu-text"},[t._v("附件：")]):t._e(),t._v(" "),s("ul",{staticClass:"file-list"},t._l(t.files,function(e){return s("li",{key:e.filename},[s("a",{staticClass:"tmcu-btn",attrs:{href:"/api/general/download/"+e.filename+"/"+e.name}},[s("i",{staticClass:"el-icon-document"}),t._v(" "),s("span",[t._v(t._s(e.name))])])])}))])},staticRenderFns:[]};var $t=s("VU/8")(kt,Dt,!1,function(t){s("a3j2")},"data-v-6f99cb1a",null).exports,Ct=s("ifQC"),xt={name:"ViewStuSubsDialog",components:{MarkdownEditor:H,FileList:$t,FullscreenDialog:P},computed:{dvRows:function(){for(var t=[{name:"已提交"},{name:"未提交"}],e=[],s=0;s<this.submissions.length;s+=1)!0===this.submissions[s].commit?(t[0][this.submissions[s].hwTitle]=1,t[1][this.submissions[s].hwTitle]=0):(t[0][this.submissions[s].hwTitle]=0,t[1][this.submissions[s].hwTitle]=1),e.push(this.submissions[s].hwTitle);var a=(new Ct.View).source(t);return a.transform({type:"fold",fields:e,key:"hwTitle",value:"commit"}),a.rows}},data:function(){return{submissions:[],classId:"",userId:"",stuName:"",stuId:"",subDetail:{},showDetail:!1,visible:!1,loading:!1,scale:[{dataKey:"hwTitle",alias:"作业名称"}],labels:{formatter:function(t){return t.length>6?t.slice(0,5)+"..":t}},height:400}},methods:{show:function(t,e,s,a){var r=this;this.visible=!0,this.loading=!0,this.showDetail=!1,this.stuName=s,this.stuId=a,this.classId=t,this.userId=e,function(t,e){return new h.a(function(s,a){g.get("/api/teacher/getStuSubs",{classId:t,userId:e}).then(function(t){1===t.stats?s(t.data.subs):a(t.data.error)}).catch(function(){a("网络错误")})})}(t,e).then(function(t){r.submissions=t,r.loading=!1}).catch(function(t){r.loading=!1,r.$message.error(t)})},showSubDetail:function(t){if("已提交"===t.data._origin.name){for(var e=0;e<this.submissions.length;e+=1)if(this.submissions[e].hwTitle===t.data._origin.hwTitle){var s=this.submissions[e];this.subDetail={hwTitle:s.hwTitle,date:s.date,answer:s.answer,files:s.files,checked:s.checked,feedback:s.feedback};break}this.showDetail=!0}else this.showDetail=null},formateDate:function(t){return ht.formateDate(+t)},closeDialog:function(){this.visible=!1}}},It={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fullscreen-dialog",{attrs:{title:t.stuName+"("+t.stuId+")-所有作业提交的数据统计",visible:t.visible},on:{close:t.closeDialog}},[s("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[s("v-chart",{attrs:{forceFit:!0,height:t.height,data:t.dvRows,scale:t.scale}},[s("v-tooltip",{attrs:{itemTpl:"<li></li>"}}),t._v(" "),s("v-axis",{attrs:{dataKey:"hwTitle",label:t.labels,title:!0}}),t._v(" "),s("v-axis",{attrs:{dataKey:"commit",label:null,line:null}}),t._v(" "),s("v-legend",{attrs:{clickable:!1}}),t._v(" "),s("v-stack-bar",{attrs:{position:"hwTitle*commit",color:"name",onClick:t.showSubDetail}})],1)],1),t._v(" "),s("p",[t._v("温馨提示: 点击柱状图查看每次作业的提交详情")]),t._v(" "),t.showDetail?s("div",[s("p",[t._v("作业: "+t._s(t.subDetail.hwTitle))]),t._v(" "),s("p",[s("span",[t._v("提交时间: "+t._s(t.formateDate(t.subDetail.date)))])]),t._v(" "),s("div",[t.subDetail.checked?s("p",[s("span",[t._v("已审阅")]),t._v(" "),s("span",[t._v("反馈结果: "+t._s(t.subDetail.feedback||"无"))])]):s("p",[t._v("未审阅")])]),t._v(" "),s("div",[s("p",[t._v("提交内容:")]),t._v(" "),s("markdown-editor",{attrs:{value:t.subDetail.answer,edit:!1}}),t._v(" "),s("file-list",{attrs:{files:t.subDetail.files}})],1)]):t._e(),t._v(" "),null===t.showDetail?s("p",[t._v("学生尚未提交")]):t._e()],1)},staticRenderFns:[]};var yt=s("VU/8")(xt,It,!1,function(t){s("x0yR")},"data-v-4e52a51a",null).exports,St={name:"StudentsTable",props:{students:{type:Array,default:function(){return[]}},classId:{type:String,default:""}},components:{ViewStuSubsDialog:yt},methods:{viewStudentHwsSubs:function(t){this.$refs.viewStuSubsDialogRef.show(this.classId,t.userId,t.name,t.stuId)}}},Et={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.students,stripe:""}},[s("el-table-column",{attrs:{prop:"stuId",label:"学号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){t.viewStudentHwsSubs(e.row)}}},[t._v("查看作业提交统计")])]}}])})],1),t._v(" "),s("view-stu-subs-dialog",{ref:"viewStuSubsDialogRef"})],1)},staticRenderFns:[]};var Vt=s("VU/8")(St,Et,!1,function(t){s("WKXR")},null,null).exports,At=s("mvHQ"),Lt=s.n(At),Ht={name:"Courseware",components:{UploadFiles:ct,FileList:$t},props:{coursewares:{type:Array},classId:{type:String}},computed:{reverseCoursewares:function(){return this.coursewares.map(function(t){return{title:t.title,uploadDate:t.uploadDate,files:t.files.concat()}}).reverse()}},data:function(){return{fileList:[],title:"",editingCourseware:null,loading:!1}},methods:{editCourseware:function(t){this.editingCourseware=t,this.title=t.title,this.fileList=t.files},quitEditCourseware:function(){this.editingCourseware=null,this.title="",this.fileList=[]},submitCourseware:function(){var t=this,e=this.fileList.filter(function(t){return ht.isFile(t)}),s=this.fileList.filter(function(t){return ht.isPureObject(t)});this.loading=!0;var a,r,i=new pt({files:e,existFiles:Lt()(s),title:this.title,uploadDate:Date.now()});(a=this.classId,r=i,new h.a(function(t,e){g.post("/api/teacher/uploadCourseware/"+a,r).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){t.$emit("fetchData"),t.title="",t.fileList=[],t.loading=!1}).catch(function(e){t.loading=!1,t.$message.error(e)})},updateCourseware:function(){var t=this,e=this.fileList.filter(function(t){return ht.isFile(t)}),s=this.fileList.filter(function(t){return ht.isPureObject(t)});this.loading=!0;var a,r,i,n=new pt({files:e,existFiles:Lt()(s),title:this.title});(a=this.classId,r=this.editingCourseware.uploadDate,i=n,new h.a(function(t,e){g.put("/api/teacher/updateCourseware/"+a+"/"+r,i).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){t.$emit("fetchData"),t.editingCourseware=null,t.title="",t.fileList=[],t.loading=!1}).catch(function(e){t.loading=!1,t.$message.error(e)})},deleteCourseware:function(t){var e=this;this.$confirm("确认删除课件-"+t.title+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s,a,r,i=e.$loading({lock:!0,text:"正在删除...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});(s=e.classId,a=t.uploadDate,new h.a(function(t,e){g.put("/api/teacher/deleteCourseware/"+s+"/"+a,r).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){i.close(),e.$emit("fetchData"),e.$message.success("删除成功")}).catch(function(t){i.close(),e.$message.error(t)})}).catch(function(){})},formateDate:function(t){return ht.formateDate(+t)}}},Rt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"courseware"},[s("el-row",[s("el-col",{attrs:{span:12}},[s("div",t._l(t.reverseCoursewares,function(e){return s("div",{key:e.uploadDate,staticClass:"courseware-item"},[s("div",[s("span",{staticClass:"courseware-title"},[t._v(t._s(e.title))]),t._v(" "),"teacher"===t.$store.state.user.role?s("span",[s("span",{staticClass:"tmcu-btn",on:{click:function(s){t.editCourseware(e)}}},[t._v("编辑")]),t._v(" "),s("span",{staticClass:"tmcu-btn",on:{click:function(s){t.deleteCourseware(e)}}},[t._v("删除")])]):t._e()]),t._v(" "),s("p",{staticClass:"tmcu-text"},[t._v(t._s(t.formateDate(e.uploadDate)))]),t._v(" "),s("file-list",{attrs:{files:e.files}})],1)}))]),t._v(" "),s("el-col",{attrs:{span:12}},["teacher"===t.$store.state.user.role?s("div",{staticClass:"edit-courseware"},[s("p",{staticClass:"courseware-title"},[t._v("\n          "+t._s(t.editingCourseware?"编辑课件-"+t.editingCourseware.title:"新增课件")+"\n        ")]),t._v(" "),s("el-input",{staticClass:"edit-title",attrs:{placeholder:"标题(可选)"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v(" "),s("upload-files",{attrs:{files:t.fileList},on:{change:function(e){return t.fileList=e}}}),t._v(" "),t.editingCourseware?s("div",{staticClass:"edit-courseware-btn"},[s("el-button",{attrs:{loading:t.loading},on:{click:t.updateCourseware}},[t._v("提交修改")]),t._v(" "),s("el-button",{on:{click:t.quitEditCourseware}},[t._v("放弃修改，新增课件")])],1):s("div",{staticClass:"edit-courseware-btn"},[s("el-button",{attrs:{loading:t.loading},on:{click:t.submitCourseware}},[t._v("提交")])],1)],1):t._e()])],1)],1)},staticRenderFns:[]};var Tt={name:"EditClassDialog",components:{MarkdownEditor:H,FullscreenDialog:P},data:function(){return{classId:"",visible:!1,loading:!1,ruleForm:{name:"",teacherName:"",password:"",message:""},rules:{name:[{required:!0,validator:function(t,e,s){""===e?s(new Error("必填")):s()},trigger:"blur"}],password:[{required:!0,validator:function(t,e,s){""===e?s(new Error("请输入密码")):s()},trigger:"blur"}]}}},methods:{show:function(t){this.classId=t.classId,this.ruleForm.name=t.name,this.ruleForm.teacherName=t.teacherName,this.ruleForm.password=t.password,this.ruleForm.message=t.message,this.visible=!0},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){var s,a;t&&(e.loading=!0,(s=e.classId,a={name:e.ruleForm.name,teacherName:e.ruleForm.teacherName,password:e.ruleForm.password,message:e.ruleForm.message},new h.a(function(t,e){g.put("/api/teacher/editClass/"+s,a).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.visible=!1,e.loading=!1,e.$emit("fetchData")}).catch(function(t){e.loading=!1,e.$message.error(t)}))})},closeDialog:function(){this.visible=!1,this.$refs.ruleForm.clearValidate()}}},Pt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fullscreen-dialog",{attrs:{title:"修改班级信息",visible:t.visible},on:{close:t.closeDialog}},[s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"班级Id"}},[s("p",[t._v(t._s(t.classId))])]),t._v(" "),s("el-form-item",{attrs:{label:"班级名称",prop:"name"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"其他信息",prop:"message"}},[s("markdown-editor",{attrs:{value:t.ruleForm.message},on:{change:function(e){return t.ruleForm.message=e}}})],1),t._v(" "),s("el-form-item",{attrs:{label:"任课教师",prop:"teacherName"}},[s("el-input",{attrs:{"auto-complete":"on"},model:{value:t.ruleForm.teacherName,callback:function(e){t.$set(t.ruleForm,"teacherName",e)},expression:"ruleForm.teacherName"}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:t.closeDialog}},[t._v("取消")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:t.loading},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var Nt={name:"ViewAllSubsDialog",components:{FullscreenDialog:P},data:function(){var t=this;return{homeworks:[],visible:!1,scale:[{dataKey:"amountOfSubs",alias:"提交人数",tickInterval:1,min:0},{dataKey:"title",alias:"作业名称"},{dataKey:"createDate",alias:"创建时间",formatter:function(e){return t.formateDate(e)}},{dataKey:"beginDate",alias:"开始时间",formatter:function(e){return t.formateDate(e)}},{dataKey:"endDate",alias:"截止时间",formatter:function(e){return t.formateDate(e)}}],crosshairs:{type:"line"},labels:{formatter:function(t){return t.length>6?t.slice(0,3)+"..":t}},axisLine:{lineWidth:2,stroke:"#dedede"},tickLine:{lineWidth:1,stroke:"#d1d1d1",strokeOpacity:1,length:5},height:400}},methods:{show:function(t){this.homeworks=t,this.visible=!0},formateDate:function(t){return ht.formateDate(+t)},closeDialog:function(){this.visible=!1}}},Mt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fullscreen-dialog",{attrs:{title:"所有作业提交的数据统计",visible:t.visible},on:{close:t.closeDialog}},[s("v-chart",{attrs:{forceFit:!0,height:t.height,data:t.homeworks,scale:t.scale}},[s("v-tooltip",{attrs:{crosshairs:t.crosshairs,showTitle:!1}}),t._v(" "),s("v-axis",{attrs:{dataKey:"title",label:t.labels,title:!0}}),t._v(" "),s("v-axis",{attrs:{dataKey:"amountOfSubs",line:t.axisLine,tickLine:t.tickLine,title:!0}}),t._v(" "),s("v-line",{attrs:{position:"title*amountOfSubs",tooltip:"title*createDate*beginDate*endDate*amountOfSubs"}}),t._v(" "),s("v-point",{attrs:{position:"title*amountOfSubs",shape:"circle"}})],1)],1)},staticRenderFns:[]};var Ut={name:"ClassPage",created:function(){this.fetchData()},components:{AddHomeworkDialog:bt,HomeworkItem:Ft,StudentsTable:Vt,CoursewarePane:s("VU/8")(Ht,Rt,!1,function(t){s("Pufh")},"data-v-37d17c72",null).exports,MarkdownEditor:H,EditClassDialog:s("VU/8")(Tt,Pt,!1,function(t){s("Tzlt")},"data-v-5713c1f1",null).exports,ViewAllSubsDialog:s("VU/8")(Nt,Mt,!1,function(t){s("NGYI")},"data-v-599e754d",null).exports,ViewStuSubsDialog:yt},data:function(){return{classs:{classId:"",name:"",teacherName:"",password:"",message:"",students:[],homeworks:[],coursewares:[]},activeTabName:"homework",addHwDialogVisible:!1}},computed:{reverseHomeworks:function(){return this.classs.homeworks.slice().reverse()}},methods:{fetchData:function(){var t,e=this;(t=this.$route.params.classId,new h.a(function(e,s){g.get("/api/general/getHws",{classId:t}).then(function(t){1===t.stats?e(t.data.class):s(t.data.error)}).catch(function(){s("网络错误")})})).then(function(t){e.classs=t}).catch(function(t){e.$message.error(t)})},addHomework:function(){this.addHwDialogVisible=!0},showEditClassDialog:function(){this.$refs.editClassDialogRef.show(this.classs)},viewAllSubs:function(){this.$refs.viewAllSubsDialogRef.show(this.classs.homeworks)},viewStudentHwsSubs:function(){this.$refs.viewStuSubsDialogRef.show(this.classs.classId,this.classs.students[0].userId,this.classs.students[0].name,this.classs.students[0].stuId)}}},zt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.$store.state.user.name&&t.classs.classId?s("div",[s("vue-headful",{attrs:{title:"高校教学管理系统 | 班级"}}),t._v(" "),s("div",[s("div",{staticClass:"custom-card"},[s("div",[s("router-link",{staticClass:"card-text-btn",attrs:{to:"/"}},[s("i",{staticClass:"el-icon-arrow-left"}),t._v(" "),s("span",[t._v("回主页")])]),t._v(" "),s("span",{staticClass:"class-name"},[t._v(t._s(t.classs.name))]),t._v(" "),"teacher"===t.$store.state.user.role?s("span",[s("el-button",{staticClass:"el-text-btn",attrs:{type:"text"},on:{click:function(e){t.showEditClassDialog()}}},[s("span",[t._v("编辑班级信息")]),t._v(" "),s("i",{staticClass:"el-icon-edit"})])],1):t._e()],1),t._v(" "),s("p",[s("span",{staticClass:"class-info tmcu-text"},[t._v("班级Id："+t._s(t.classs.classId))]),t._v(" "),s("span",{staticClass:"class-info tmcu-text"},[t._v("密码："+t._s(t.classs.password))]),t._v(" "),s("span",{staticClass:"class-info tmcu-text"},[t._v("任课教师："+t._s(t.classs.teacherName))])])]),t._v(" "),t.classs.message?s("markdown-editor",{attrs:{value:t.classs.message,edit:!1}}):t._e()],1),t._v(" "),s("el-tabs",{model:{value:t.activeTabName,callback:function(e){t.activeTabName=e},expression:"activeTabName"}},[s("el-tab-pane",{attrs:{label:"作业",name:"homework"}},[s("div",{staticClass:"hw-container"},["teacher"===t.$store.state.user.role?s("div",{staticClass:"hw-content"},[s("span",{staticClass:"hw-total"},[t._v("作业数量: "+t._s(t.classs.homeworks.length))]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.addHomework}},[t._v("创建作业")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.viewAllSubs}},[t._v("数据统计")])],1):s("div",{staticClass:"hw-content"},[s("span",{staticClass:"hw-total"},[t._v("作业数量: "+t._s(t.classs.homeworks.length))]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.viewStudentHwsSubs}},[t._v("数据统计")])],1)]),t._v(" "),s("div",t._l(t.reverseHomeworks,function(e){return s("homework-item",{key:e.createDate,attrs:{classId:t.classs.classId,homework:e}})}))]),t._v(" "),s("el-tab-pane",{attrs:{label:"课件",name:"courseware"}},[s("courseware-pane",{attrs:{coursewares:t.classs.coursewares,classId:t.classs.classId},on:{fetchData:t.fetchData}})],1),t._v(" "),"teacher"===t.$store.state.user.role?s("el-tab-pane",{attrs:{label:"学生",name:"student"}},[s("p",[t._v("学生数量: "+t._s(t.classs.students.length))]),t._v(" "),s("div",[s("students-table",{attrs:{students:t.classs.students,classId:t.classs.classId}})],1)]):t._e()],1),t._v(" "),s("add-homework-dialog",{attrs:{dialogVisible:t.addHwDialogVisible,classId:t.classs.classId},on:{hideDialog:function(e){t.addHwDialogVisible=!1},fetchData:t.fetchData}}),t._v(" "),s("edit-class-dialog",{ref:"editClassDialogRef",on:{fetchData:t.fetchData}}),t._v(" "),s("view-all-subs-dialog",{ref:"viewAllSubsDialogRef"}),t._v(" "),s("view-stu-subs-dialog",{ref:"viewStuSubsDialogRef"})],1):t._e()},staticRenderFns:[]};var Gt=s("VU/8")(Ut,zt,!1,function(t){s("ou9A")},"data-v-1044539b",null).exports,Ot={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("vue-headful",{attrs:{title:"高校教学管理系统 | 页面不存在"}}),this._v(" "),e("p",[this._v("404")])],1)},staticRenderFns:[]};var qt=s("VU/8")({name:"NotFound"},Ot,!1,function(t){s("Xoso")},"data-v-1aa35af3",null).exports;var Zt={name:"ShowStuSubDialog",props:{classId:{type:String,default:""},createDate:{type:String,default:Date.now()}},components:{MarkdownEditor:H,FileList:$t,FullscreenDialog:P},data:function(){return{visible:!1,submission:{userId:"",stuId:"",stuName:"",email:"",date:"",answer:"",file:"",checked:!1,feedback:""},feedback:""}},methods:{closeDialog:function(){this.visible=!1},show:function(t){this.visible=!0,this.submission.userId=t.userId,this.submission.stuId=t.stuId,this.submission.stuName=t.stuName,this.submission.email=t.email,this.submission.date=t.date,this.submission.answer=t.answer,this.submission.files=t.files,this.submission.checked=t.checked,this.submission.feedback=t.feedback},submitFeedback:function(){var t,e,s,a,r=this;(t=this.classId,e=this.createDate,s=this.submission.userId,a=this.feedback,new h.a(function(r,i){g.put("/api/teacher/feedbackHw/"+t+"/"+e+"/"+s,{feedback:a}).then(function(t){0===t.stats?i(t.data.error):r()}).catch(function(){i("网络错误")})})).then(function(){r.visible=!1,r.$emit("fetchData")}).catch(function(t){r.$message.error(t)})},formateDate:function(t){return ht.formateDate(+t)}}},jt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fullscreen-dialog",{attrs:{title:t.submission.stuName+"("+t.submission.stuId+")提交详情",visible:t.visible},on:{close:t.closeDialog}},[s("p",[t._v("提交时间: "+t._s(t.formateDate(t.submission.date)))]),t._v(" "),s("div",[s("markdown-editor",{attrs:{value:t.submission.answer,edit:!1}}),t._v(" "),s("file-list",{attrs:{files:t.submission.files}})],1),t._v(" "),s("div",[t.submission.checked?s("p",[s("span",[t._v("已审阅")]),t._v(" "),s("span",[t._v("反馈结果: "+t._s(t.submission.feedback||"无"))])]):s("div",[s("p",[t._v("未审阅")]),t._v(" "),s("div",[s("p",[t._v("填写反馈:")]),t._v(" "),s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:10},placeholder:"请输入内容"},model:{value:t.feedback,callback:function(e){t.feedback=e},expression:"feedback"}})],1),t._v(" "),s("div",{staticClass:"submit-btn"},[s("el-button",{attrs:{type:"primary"},on:{click:t.submitFeedback}},[t._v("提交")])],1)])])])},staticRenderFns:[]};var Bt=s("VU/8")(Zt,jt,!1,function(t){s("uDYM")},"data-v-3a842f52",null).exports,Kt={name:"SubmissionsTable",props:{submissions:{type:Array,default:function(){return[]}},classId:{type:String,default:""},createDate:{type:String,default:Date.now()}},components:{ShowStuSubDialog:Bt},methods:{viewStudentHwSub:function(t){this.$refs.showStuSubDialogRef.show(t)},formatterDate:function(t,e,s){return this.formateDate(s)},formatterStatus:function(t){return t?"已审阅":"未审阅"},formatterFeedback:function(t,e,s){return t.checked&&s||t.checked&&"无"||"--"},formateDate:function(t){return ht.formateDate(+t)}}},Jt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.submissions,stripe:""}},[s("el-table-column",{attrs:{prop:"stuId",label:"学号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"stuName",label:"姓名"}}),t._v(" "),s("el-table-column",{attrs:{prop:"date",label:"提交时间",formatter:t.formatterDate}}),t._v(" "),s("el-table-column",{attrs:{prop:"checked",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-tag",{attrs:{type:e.row.checked?"info":"success",size:"small"}},[t._v("\n          "+t._s(t.formatterStatus(e.row.checked))+"\n        ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"feedback",label:"反馈",formatter:t.formatterFeedback}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){t.viewStudentHwSub(e.row)}}},[t._v("查看")])]}}])})],1),t._v(" "),s("show-stu-sub-dialog",{ref:"showStuSubDialogRef",attrs:{classId:t.classId,createDate:t.createDate},on:{fetchData:function(e){t.$emit("fetchData")}}})],1)},staticRenderFns:[]};var Yt=s("VU/8")(Kt,Jt,!1,function(t){s("Dqvi")},null,null).exports,Wt={name:"SubmitHomework",components:{MarkdownEditor:H,UploadFiles:ct},props:{classId:{type:String,default:""},createDate:{type:String,default:Date.now()},text:{type:String,default:Date.now()},files:{type:Array,default:function(){return[]}},editing:{type:Boolean,default:!1}},data:function(){return{answer:this.text,fileList:this.files,loading:!1}},methods:{submitAnswer:function(){var t,e,s,a=this,r=new pt({files:this.fileList,answer:this.answer,date:Date.now()});this.loading=!0,(t=this.classId,e=this.createDate,s=r,new h.a(function(a,r){g.post("/api/student/submitHw/"+t+"/"+e,s).then(function(t){0===t.stats?r(t.data.error):a()}).catch(function(){r("网络错误")})})).then(function(){a.loading=!1,a.$emit("fetchData")}).catch(function(t){a.loading=!1,a.$message.error(t)})},updateAnswer:function(){var t,e,s,a=this,r=this.fileList.filter(function(t){return ht.isFile(t)}),i=this.fileList.filter(function(t){return ht.isPureObject(t)}),n=new pt({files:r,existFiles:Lt()(i),answer:this.answer,date:Date.now()});this.loading=!0,(t=this.classId,e=this.createDate,s=n,new h.a(function(a,r){g.put("/api/student/editHwSub/"+t+"/"+e,s).then(function(t){0===t.stats?r(t.data.error):a()}).catch(function(){r("网络错误")})})).then(function(){a.loading=!1,a.$emit("fetchData")}).catch(function(t){a.loading=!1,a.$message.error(t)})},resetAnswer:function(){this.answer="",this.fileList=[]}}},Qt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("markdown-editor",{attrs:{value:t.answer},on:{change:function(e){return t.answer=e}}}),t._v(" "),s("upload-files",{attrs:{files:t.fileList},on:{change:function(e){return t.fileList=e}}}),t._v(" "),s("div",{staticClass:"submit-btn"},[s("el-button",{on:{click:t.resetAnswer}},[t._v("清空")]),t._v(" "),t.editing?s("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.updateAnswer}},[t._v("提交")]):s("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submitAnswer}},[t._v("提交")])],1)],1)},staticRenderFns:[]};var Xt=s("VU/8")(Wt,Qt,!1,function(t){s("AEiT")},null,null).exports,te={name:"AddHomeworkDialog",props:{classId:{type:String,default:""},createDate:{type:String,default:""}},components:{MarkdownEditor:H,UploadFiles:ct,FileList:$t,FullscreenDialog:P},data:function(){return{answer:"",staticAnswer:"",fileList:[],staticFileList:[],editable:!1,visible:!1,loading:!1}},methods:{show:function(t){this.answer=t.answer,this.staticAnswer=t.answer,this.fileList=t.files.map(function(t){return{name:t.name,filename:t.filename}}),this.staticFileList=t.files.map(function(t){return{name:t.name,filename:t.filename}}),this.editable=!1,this.visible=!0},submitHwAnswer:function(){var t,e,s,a=this,r=this.fileList.filter(function(t){return ht.isFile(t)}),i=this.fileList.filter(function(t){return ht.isPureObject(t)}),n=new pt({files:r,existFiles:Lt()(i),answer:this.answer});this.loading=!0,(t=this.classId,e=this.createDate,s=n,new h.a(function(a,r){g.post("/api/teacher/uploadHwAnswer/"+t+"/"+e,s).then(function(t){0===t.stats?r(t.data.error):a()}).catch(function(){r("网络错误")})})).then(function(){a.visible=!1,a.loading=!1,a.$emit("fetchData"),a.$message.success("上传成功")}).catch(function(t){a.loading=!1,a.$message.error(t)})},deleteAnswer:function(){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e,s;t.loading=!0,(e=t.classId,s=t.createDate,new h.a(function(t,a){g.put("/api/teacher/deleteHwAnswer/"+e+"/"+s).then(function(e){0===e.stats?a(e.data.error):t()}).catch(function(){a("网络错误")})})).then(function(){t.visible=!1,t.loading=!1,t.$emit("fetchData"),t.$message.success("删除成功")}).catch(function(e){t.loading=!1,t.$message.error(e)})}).catch(function(){})},cancelEdit:function(){this.editable=!1},closeDialog:function(){this.visible=!1}}},ee={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fullscreen-dialog",{attrs:{title:"答案",visible:t.visible},on:{close:t.closeDialog}},["student"===t.$store.state.user.role?s("div",[t.staticAnswer||t.staticFileList.length?s("div",[t.staticAnswer?s("markdown-editor",{attrs:{value:t.staticAnswer,edit:!1}}):t._e(),t._v(" "),s("file-list",{attrs:{files:t.staticFileList}})],1):s("p",[t._v("暂无答案")])]):t._e(),t._v(" "),"teacher"===t.$store.state.user.role?s("div",[t.editable||!t.staticAnswer&&!t.staticFileList.length?s("div",[s("div",{staticClass:"answer-op"},[t.staticAnswer||t.staticFileList.length?s("el-button",{on:{click:t.cancelEdit}},[t._v("取消编辑")]):t._e(),t._v(" "),s("el-button",{attrs:{loading:t.loading},on:{click:t.submitHwAnswer}},[t._v("\n          "+t._s(t.loading?"提交中...":"提交")+"\n        ")])],1),t._v(" "),s("markdown-editor",{attrs:{value:t.answer},on:{change:function(e){return t.answer=e}}}),t._v(" "),s("div",{staticClass:"answer-upload"},[s("upload-files",{attrs:{files:t.fileList},on:{change:function(e){return t.fileList=e}}})],1)],1):s("div",[s("div",{staticClass:"answer-op"},[s("el-button",{on:{click:function(e){t.editable=!0}}},[t._v("编辑")]),t._v(" "),s("el-button",{attrs:{loading:t.loading},on:{click:t.deleteAnswer}},[t._v("\n          "+t._s(t.loading?"删除中...":"删除")+"\n        ")])],1),t._v(" "),s("markdown-editor",{attrs:{value:t.staticAnswer,edit:!1}}),t._v(" "),s("file-list",{attrs:{files:t.staticFileList}})],1)]):t._e()])},staticRenderFns:[]};var se=s("VU/8")(te,ee,!1,function(t){s("lrNd")},"data-v-04ff247e",null).exports,ae={name:"EditHomeworkDialog",components:{MarkdownEditor:H,UploadFiles:ct,FullscreenDialog:P},props:{classId:{type:String,default:""},createDate:{type:String,default:""}},data:function(){return{visible:!1,loading:!1,fileList:[],ruleForm:{title:"",description:"",beginDate:"",endDate:""},rules:{title:[{required:!0,validator:function(t,e,s){""===e?s(new Error("必填")):s()},trigger:"blur"}]},pickerOptions:{shortcuts:[{text:"三天后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+2592e5),t.$emit("pick",e)}},{text:"五天后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+432e6),t.$emit("pick",e)}},{text:"一周后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+6048e5),t.$emit("pick",e)}},{text:"两周后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+12096e5),t.$emit("pick",e)}}]}}},methods:{show:function(t){this.fileList=t.files,this.ruleForm.title=t.title,this.ruleForm.description=t.description,this.ruleForm.beginDate=new Date(+t.beginDate),this.ruleForm.endDate=new Date(+t.endDate),this.visible=!0},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var s=e.fileList.filter(function(t){return ht.isFile(t)}),a=e.fileList.filter(function(t){return ht.isPureObject(t)}),r=new pt({files:s,existFiles:Lt()(a),title:e.ruleForm.title,description:e.ruleForm.description,beginDate:e.ruleForm.beginDate.getTime(),endDate:e.ruleForm.endDate.getTime()});e.loading=!0,(i=e.classId,n=e.createDate,o=r,new h.a(function(t,e){g.put("/api/teacher/editHw/"+i+"/"+n,o).then(function(s){0===s.stats?e(s.data.error):t()}).catch(function(){e("网络错误")})})).then(function(){e.visible=!1,e.loading=!1,e.$emit("fetchData")}).catch(function(t){e.loading=!1,e.$message.error(t)})}var i,n,o})},closeDialog:function(){this.visible=!1,this.$refs.ruleForm.clearValidate()}}},re={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fullscreen-dialog",{attrs:{title:"修改作业信息",visible:t.visible},on:{close:t.closeDialog}},[s("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"作业标题",prop:"title"}},[s("el-input",{model:{value:t.ruleForm.title,callback:function(e){t.$set(t.ruleForm,"title",e)},expression:"ruleForm.title"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"作业详情",prop:"description"}},[s("markdown-editor",{attrs:{value:t.ruleForm.description},on:{change:function(e){return t.ruleForm.description=e}}})],1),t._v(" "),s("el-form-item",{attrs:{label:"开始时间",prop:"beginDate"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.ruleForm.beginDate,callback:function(e){t.$set(t.ruleForm,"beginDate",e)},expression:"ruleForm.beginDate"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"结束时间",prop:"endDate"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","picker-options":t.pickerOptions},model:{value:t.ruleForm.endDate,callback:function(e){t.$set(t.ruleForm,"endDate",e)},expression:"ruleForm.endDate"}})],1),t._v(" "),s("div",{staticClass:"form-item-upload"},[s("upload-files",{attrs:{files:t.fileList},on:{change:function(e){return t.fileList=e}}})],1),t._v(" "),s("el-form-item",[s("el-button",{on:{click:t.closeDialog}},[t._v("取消")]),t._v(" "),s("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var ie={name:"HomeworkPage",created:function(){this.fetchData()},components:{SubmissionsTable:Yt,SubmitHomework:Xt,MarkdownEditor:H,FileList:$t,HwAnswerDialog:se,EditHomeworkDialog:s("VU/8")(ae,re,!1,function(t){s("48aW")},"data-v-e96bb39a",null).exports},computed:{expired:function(){return this.homework.beginDate>Date.now()?0:this.homework.endDate<Date.now()?1:2}},data:function(){return{homework:{createDate:"",beginDate:"",endDate:"",title:"",description:"",submissions:[],files:[],hwAnswer:{answer:"",files:[]}},editingSub:null,loading:!1}},methods:{fetchData:function(){var t,e,s=this;(t=this.$route.params.classId,e=this.$route.params.createDate,new h.a(function(s,a){g.get("/api/general/getSubs",{classId:t,createDate:e}).then(function(t){1===t.stats?s(t.data.homework):a(t.data.error)}).catch(function(){a("网络错误")})})).then(function(t){s.homework=t,s.editingSub=null}).catch(function(t){s.$message.error(t)})},deleteHwSub:function(){var t,e,s,a=this;this.loading=!0,(t=this.$route.params.classId,e=this.$route.params.createDate,new h.a(function(a,r){g.put("/api/student/deleteHwSub/"+t+"/"+e,s).then(function(t){0===t.stats?r(t.data.error):a()}).catch(function(){r("网络错误")})})).then(function(){a.loading=!1,a.fetchData()}).catch(function(t){a.loading=!1,a.$message.error(t)})},formateDate:function(t){return ht.formateDate(+t)},showHwAnswerDialog:function(){this.$refs.hwAnswerDialogRef.show(this.homework.hwAnswer)},showEditHomeworkDialog:function(){this.$refs.editHomeworkDialogRef.show(this.homework)}},filters:{hwStatus:function(t){return 0===t?"未开始":1===t?"已截止":"进行中"},answerStatus:function(t,e,s){return e||s?"查看答案":"student"===t?"暂无答案":"上传答案"}}},ne={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.$store.state.user.name&&t.homework.createDate?s("div",[s("vue-headful",{attrs:{title:"高校教学管理系统 | 作业"}}),t._v(" "),s("div",{staticClass:"hw-box"},[s("div",{staticClass:"custom-card"},[s("p",[s("router-link",{staticClass:"card-text-btn",attrs:{to:"/class/"+t.$route.params.classId}},[s("i",{staticClass:"el-icon-arrow-left"}),t._v(" "),s("span",[t._v("回班级主页")])]),t._v(" "),s("span",{staticClass:"hw-title"},[t._v(t._s(t.homework.title))]),t._v(" "),s("span",{class:"hw-stauts-"+t.expired},[t._v(t._s(t._f("hwStatus")(t.expired)))]),t._v(" "),"teacher"===t.$store.state.user.role?s("span",[s("el-button",{attrs:{type:"text"},on:{click:function(e){t.showEditHomeworkDialog()}}},[s("span",[t._v("编辑作业信息")]),t._v(" "),s("i",{staticClass:"el-icon-edit"})])],1):t._e(),t._v(" "),s("span",{staticClass:"hw-answer tmcu-btn",on:{click:function(e){t.showHwAnswerDialog()}}},[t._v("\n          "+t._s(t._f("answerStatus")(t.$store.state.user.role,t.homework.hwAnswer.answer,t.homework.hwAnswer.files.length))+"\n        ")])],1),t._v(" "),s("p",[s("span",{staticClass:"hw-info tmcu-text"},[t._v("创建时间: "+t._s(t.formateDate(t.homework.createDate)))]),t._v(" "),s("span",{staticClass:"hw-info tmcu-text"},[t._v("开始时间: "+t._s(t.formateDate(t.homework.beginDate)))]),t._v(" "),s("span",{staticClass:"hw-info tmcu-text"},[t._v("截止时间: "+t._s(t.formateDate(t.homework.endDate)))])])]),t._v(" "),s("markdown-editor",{attrs:{value:t.homework.description,edit:!1}}),t._v(" "),s("file-list",{attrs:{files:t.homework.files}})],1),t._v(" "),"teacher"===t.$store.state.user.role?s("div",[s("p",{staticClass:"tmcu-text"},[t._v("共 "+t._s(t.homework.submissions.length)+" 人提交")]),t._v(" "),s("submissions-table",{attrs:{submissions:t.homework.submissions,classId:t.$route.params.classId,createDate:t.homework.createDate},on:{fetchData:t.fetchData}})],1):t._e(),t._v(" "),"student"===t.$store.state.user.role?s("div",[t.homework.submissions.length?s("div",[s("p",{staticClass:"tmcu-text"},[s("span",[t._v("已提交")]),t._v(" "),t.homework.submissions[0].checked||2!==t.expired?t._e():s("span",[s("el-button",{attrs:{type:"text"},on:{click:function(e){t.editingSub=t.homework.submissions[0]}}},[t._v("编辑")])],1),t._v(" "),t.homework.submissions[0].checked||2!==t.expired?t._e():s("span",[s("el-button",{attrs:{type:"text",loading:t.loading},on:{click:t.deleteHwSub}},[t._v("撤销")])],1)]),t._v(" "),s("p",{staticClass:"tmcu-text"},[s("span",[t._v("姓名: "+t._s(t.homework.submissions[0].stuName))]),t._v(" "),s("span",[t._v("学号: "+t._s(t.homework.submissions[0].stuId))]),t._v(" "),s("span",[t._v("提交时间: "+t._s(t.formateDate(t.homework.submissions[0].date)))])]),t._v(" "),s("div",{staticClass:"tmcu-text"},[t.homework.submissions[0].checked?s("p",[s("span",[t._v("老师已审阅")]),t._v(" "),s("span",[t._v("反馈结果: "+t._s(t.homework.submissions[0].feedback||"无"))])]):s("p",[t._v("老师还未审阅")])]),t._v(" "),t.editingSub?s("div",[s("p",[s("span",{staticClass:"tmcu-text"},[t._v("修改已提交作业")]),t._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(e){t.editingSub=null}}},[t._v("放弃修改")])],1),t._v(" "),s("submit-homework",{attrs:{classId:t.$route.params.classId,createDate:t.homework.createDate,text:t.editingSub.answer,files:t.editingSub.files,editing:!0},on:{fetchData:t.fetchData}})],1):s("div",[s("p",{staticClass:"tmcu-text"},[t._v("提交详情:")]),t._v(" "),s("markdown-editor",{attrs:{value:t.homework.submissions[0].answer,edit:!1}}),t._v(" "),s("file-list",{attrs:{files:t.homework.submissions[0].files}})],1)]):s("div",[s("p",{staticClass:"tmcu-text"},[t._v("未提交")]),t._v(" "),2===t.expired?s("submit-homework",{attrs:{classId:t.$route.params.classId,createDate:t.homework.createDate,text:"",files:[],editing:!1},on:{fetchData:t.fetchData}}):t._e()],1)]):t._e(),t._v(" "),s("hw-answer-dialog",{ref:"hwAnswerDialogRef",attrs:{classId:t.$route.params.classId,createDate:t.homework.createDate},on:{fetchData:t.fetchData}}),t._v(" "),s("edit-homework-dialog",{ref:"editHomeworkDialogRef",attrs:{classId:t.$route.params.classId,createDate:t.homework.createDate},on:{fetchData:t.fetchData}})],1):t._e()},staticRenderFns:[]};var oe=s("VU/8")(ie,ne,!1,function(t){s("N1Mz")},"data-v-6bf9ce9c",null).exports;a.default.use(x.a);var le=new x.a({mode:"history",routes:[{path:"/",name:"Home",component:Z},{path:"/regist",name:"RegistPage",component:W},{path:"/login",name:"LoginPage",component:tt},{path:"/forgot",name:"ForgotPassword",component:at},{path:"/reset/:resetId",name:"ResetPassword",component:nt},{path:"/class/:classId",name:"ClassPage",component:Gt},{path:"/hw/:classId/:createDate",name:"HomeworkPage",component:oe},{path:"/*",component:qt}]}),ce=s("NYxO");a.default.use(ce.a);var ue={user:{name:"",stuId:"",role:""}},de={refreshHeader:function(){g.get("/api/general/profile").then(function(t){1===t.stats?ue.user=t.data.profile:ue.user={name:"",stuId:"",role:""}}).catch(function(){ue.user={name:"",stuId:"",role:""}})}},me=new ce.a.Store({state:ue,actions:de});a.default.config.productionTip=!1,a.default.use(i.a),a.default.use(o.a),a.default.use(u.a),a.default.component("vue-headful",m.a),a.default.component("vue-draggable",c.a),new a.default({el:"#app",router:le,store:me,render:function(t){return t(C)}})},Pufh:function(t,e){},Qhht:function(t,e){},Tzlt:function(t,e){},Uh4q:function(t,e){},Vm1m:function(t,e){},WKXR:function(t,e){},Xoso:function(t,e){},ZxD1:function(t,e){},a3j2:function(t,e){},lJbM:function(t,e){},lrNd:function(t,e){},nGs6:function(t,e){},ou9A:function(t,e){},pw1w:function(t,e){},sAEl:function(t,e){},tvR6:function(t,e){},uDYM:function(t,e){},x0yR:function(t,e){},zGTM:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.2e0e15ae7e2928c8fb78.js.map